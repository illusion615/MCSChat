<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test KPI Icon</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .icon-test {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .icon-test svg {
            flex-shrink: 0;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>KPI Icon Test</h1>
        <p>Testing the newly added KPI icon in the SVG library...</p>
        
        <div id="results">
            <!-- Results will be populated by JavaScript -->
        </div>
        
        <h3>Icon Tests:</h3>
        <div class="icon-test">
            <span data-icon="kpi"></span>
            <span>KPI Icon (via data-icon attribute)</span>
        </div>
        
        <div class="icon-test" id="directIconTest">
            <span>KPI Icon (via direct creation): </span>
        </div>
    </div>

    <script type="module">
        import { Icon } from './src/components/svg-icon-manager/index.js';
        
        const results = document.getElementById('results');
        
        function addResult(message, isSuccess = true) {
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.textContent = message;
            results.appendChild(div);
        }
        
        // Test 1: Check if Icon manager loads
        try {
            if (typeof Icon !== 'undefined') {
                addResult('✅ Icon manager loaded successfully');
            } else {
                addResult('❌ Icon manager failed to load', false);
            }
        } catch (error) {
            addResult(`❌ Error loading Icon manager: ${error.message}`, false);
        }
        
        // Test 2: Create KPI icon directly
        try {
            const kpiIcon = Icon.create('kpi', { size: '24px', color: '#0078d4' });
            if (kpiIcon) {
                document.getElementById('directIconTest').appendChild(kpiIcon);
                addResult('✅ KPI icon created successfully via Icon.create()');
            } else {
                addResult('❌ KPI icon creation returned null/undefined', false);
            }
        } catch (error) {
            addResult(`❌ Error creating KPI icon: ${error.message}`, false);
        }
        
        // Test 3: Initialize data-icon elements
        try {
            // Wait a bit for the icon system to initialize
            setTimeout(() => {
                const iconElements = document.querySelectorAll('[data-icon]');
                iconElements.forEach(element => {
                    const iconName = element.getAttribute('data-icon');
                    if (!iconName || element.children.length > 0) return;
                    
                    try {
                        const iconElement = Icon.create(iconName, {
                            size: '24px',
                            color: '#666'
                        });
                        element.appendChild(iconElement);
                        addResult(`✅ Data-icon "${iconName}" initialized successfully`);
                    } catch (error) {
                        addResult(`❌ Failed to initialize data-icon "${iconName}": ${error.message}`, false);
                    }
                });
            }, 100);
        } catch (error) {
            addResult(`❌ Error initializing data-icon elements: ${error.message}`, false);
        }
        
        // Test 4: Check if KPI icon is in the collection
        setTimeout(async () => {
            try {
                if (window.Icon && window.Icon.waitForLoad) {
                    await window.Icon.waitForLoad();
                    addResult('✅ Full icon collection loaded');
                }
            } catch (error) {
                addResult(`❌ Error waiting for full collection: ${error.message}`, false);
            }
        }, 200);
    </script>
</body>
</html>
